
# Adaptive Sliding Mode Control Based on Neural Networks for Quadrotor UAV Position Control

## Overview
This report presents the design and implementation of an adaptive sliding mode control (SMC) strategy based on neural networks for the position control of a quadrotor UAV. The SMC controller is known for its robustness in controlling nonlinear systems under uncertainties and disturbances. The adaptive component, utilizing neural networks, further enhances the controller's performance by adjusting its parameters online.

## System Dynamics
The dynamics of the quadrotor are described using coordinate frames for both the body and the earth. The key dynamic equations are derived, including translational and rotational motion equations. The control inputs for the quadrotor are the thrust and torques generated by the rotors.

### Key Equations
The rotation matrix \( R \) and the kinematic equations are given by:
\[ R = R(\phi, \theta, \psi) = R(z, \psi)R(y, \theta)R(x, \phi) \]

\[ \dot{\boldsymbol{\Phi}} = \boldsymbol{H}^{-1} \boldsymbol{\Omega} \]

The translational and rotational dynamics are:
\[ \ddot{x} = \frac{\sin \theta \cos \phi \cos \psi + \sin \phi \sin \psi}{m_s} u_1 - \frac{k_1 \dot{x}}{m_s} \]
\[ \ddot{y} = \frac{\sin \theta \cos \phi \sin \psi + \sin \phi \cos \psi}{m_s} u_1 - \frac{k_2 \dot{y}}{m_s} \]
\[ \ddot{z} = \frac{\cos \theta \cos \phi}{m_s} u_1 - g - \frac{k_3 \dot{z}}{m_s} \]

\[ \ddot{\phi} = \dot{\theta} \dot{\psi} \frac{I_y - I_z}{I_x} + \frac{J_r}{I_x} \dot{\theta} \Omega_r + \frac{l}{I_x} u_2 - \frac{k_4 l}{I_x} \dot{\phi} \]
\[ \ddot{\theta} = \dot{\phi} \dot{\psi} \frac{I_z - I_x}{I_y} - \frac{J_r}{I_y} \dot{\phi} \Omega_r + \frac{l}{I_y} u_3 - \frac{k_5 l}{I_y} \dot{\theta} \]
\[ \ddot{\psi} = \dot{\theta} \dot{\phi} \frac{I_x - I_y}{I_z} + \frac{c}{I_z} u_4 - \frac{k_6}{I_z} \dot{\psi} \]

## Sliding Mode Control (SMC)
The SMC controller is designed to ensure that the system's state follows a desired trajectory despite uncertainties and disturbances. The control law is defined to drive the system states to a sliding surface, where the system dynamics are robust against disturbances.

### SMC Formulation
The sliding surface for a state \( x \) is defined as:
\[ s = w(x_d - x) + (\dot{x}_d - \dot{x}) \]

The control input is then formulated to ensure the system state reaches and remains on this surface:
\[ u = u_{eq} + u_{dis} \]

## Adaptive Neural Network Control
An adaptive neural network is used to adjust the SMC controller parameters in real-time, improving its performance under varying conditions.

### Neural Network Adaptation
The neural network adjusts the parameters \( w \) and \( \epsilon \) using the following update laws:

#### Height Control \( u_1 \)
\[ u_1 = \frac{m_s}{\cos \theta \cos \phi} \left[ w_z (\dot{z}_d - \dot{z}) + \ddot{z}_d + g \right] + \frac{m_s}{\cos \theta \cos \phi} \left[ \varepsilon_z \tanh s_z \right] \]

Adaptive laws:
\[ \varepsilon_z = \varepsilon_{z, 0} + \eta_z \int_0^t \operatorname{sign}\left(\frac{\nabla z}{\nabla u_{1 d i s}}\right) \frac{m_s \left(z_d - z\right) \tanh s_z}{\cos \theta \cos \phi} d t \]
\[ w_z = w_{z, 0} + \eta_z \int_0^t \operatorname{sign}\left(\frac{\nabla z}{\nabla u_{1 d i s}}\right) \frac{4 m_s \varepsilon_z \left(z_d - z\right)^2 \mathrm{e}^{-2 s_z}}{\cos \theta \cos \phi \left(1 + \mathrm{e}^{-2 s_z}\right)^2} d t \]

#### Yaw Control \( u_4 \)
\[ u_4 = \frac{I_z}{c} \left[ w_\psi (\dot{\psi}_d - \dot{\psi}) + \ddot{\psi}_d \right] + \frac{I_z}{c} \left[ \varepsilon_\psi \tanh s_\psi \right] \]

Adaptive laws:
\[ \varepsilon_\psi = \varepsilon_{\psi, 0} + \eta_\psi \int_0^t \operatorname{sign}\left(\frac{\nabla \psi}{\nabla u_{4 d i s}}\right) \frac{I_z \left(\psi_d - \psi\right) \tanh s_\psi}{c} d t \]
\[ w_\psi = w_{\psi, 0} + \eta_\psi \int_0^t \operatorname{sign}\left(\frac{\nabla \psi}{\nabla u_{4 d i s}}\right) \frac{4 I_z \varepsilon_\psi \left(\psi_d - \psi\right)^2 \mathrm{e}^{-2 s_\psi}}{c \left(1 + \mathrm{e}^{-2 s_\psi}\right)^2} d t \]

#### Pitch Control \( u_3 \)
\[ u_3 = \frac{I_y}{l} \left[ \alpha_1 \left(\ddot{x}_d - \frac{\sin \theta \cos \phi \cos \psi + \sin \phi \sin \psi}{m_s} u_1\right) + \alpha_2 (\dot{x}_d - \dot{x}) + \ddot{\theta}_d + \alpha_3 (\dot{\theta}_d - \dot{\theta}) \right] + \frac{I_y}{l} \left[ \varepsilon_\theta \tanh s_\theta \right] \]

Adaptive laws:
\[ \varepsilon_\theta = \varepsilon_{\theta, 0} + \eta_\theta \int_0^t \operatorname{sign}\left(\frac{\nabla x}{\nabla u_{3 d i s}}\right) \frac{I_y \left(x_d - x\right) \tanh s_\theta}{l} d t \]
\[ w_1 = w_{1, 0} + \eta_\theta \int_0^t \operatorname{sign}\left(\frac{\nabla x}{\nabla u_{3 d i s}}\right) \frac{4 I_y m_s \varepsilon_\theta \left(x_d - x\right) \left(\dot{x}_d - \dot{x}\right) \mathrm{e}^{-2 s_\theta}}{l \cos \theta_d \cos \phi \cos \psi \left(1 + \mathrm{e}^{-2 s_\theta}\right)^2 u_1} d t \]
\[ w_2 = w_{2, 0} + \eta_\theta \int_0^t \operatorname{sign}\left(\frac{\nabla x}{\nabla u_{3 d i s}}\right) \frac{4 I_y m_s \varepsilon_\theta \left(x_d - x\right)^2 \mathrm{e}^{-2 s_\theta}}{l \cos \theta_d \cos \phi \cos \psi \left(1 + \mathrm{e}^{-2 s_\theta}\right)^2 u_1} d t \]
\[ w_3 = w_{3, 0} + \eta_\theta \int_0^t \operatorname{sign}\left(\frac{\nabla x}{\nabla u_{3 d i s}}\right) \frac{4 I_y \varepsilon_\theta \left(x_d - x\right) \left(\theta_d - \theta\right) \mathrm{e}^{-2 s_\theta}}{l \left(1 + \mathrm{e}^{-2 s_\theta}\right)^2} d t \]

#### Roll Control \( u_2 \)
\[ u_2 = \frac{I_x}{l} \left[ \alpha_4 \left(\ddot{y}_d - \frac{\sin \theta \cos \phi

 \sin \psi - \sin \phi \cos \psi}{m_s} u_1\right) + \alpha_5 (\dot{y}_d - \dot{y}) + \ddot{\phi}_d + \alpha_6 (\dot{\phi}_d - \dot{\phi}) \right] + \frac{I_x}{l} \left[ \varepsilon_\phi \tanh s_\phi \right] \]

Adaptive laws:
\[ \varepsilon_\phi = \varepsilon_{\phi, 0} + \eta_\phi \int_0^t \operatorname{sign}\left(\frac{\nabla y}{\nabla u_{2 d i s}}\right) \frac{I_x \left(y_d - y\right) \tanh s_\phi}{l} d t \]
\[ w_4 = w_{4, 0} + \eta_\phi \int_0^t \operatorname{sign}\left(\frac{\nabla y}{\nabla u_{2 d i s}}\right) \frac{4 I_x m_s \varepsilon_\phi \left(y_d - y\right) \left(\dot{y}_d - \dot{y}\right) \mathrm{e}^{-2 s_\phi}}{l \left[\sin \theta \sin \phi_d \sin \psi + \cos \phi_d \cos \psi\right] \left(1 + \mathrm{e}^{-2 s_\phi}\right)^2 u_1} d t \]
\[ w_5 = w_{5, 0} + \eta_\phi \int_0^t \operatorname{sign}\left(\frac{\nabla y}{\nabla u_{2 d i s}}\right) \frac{4 I_x m_s \varepsilon_\phi \left(y_d - y\right)^2 \mathrm{e}^{-2 s_\phi}}{l \left[\sin \theta \sin \phi_d \sin \psi + \cos \phi_d \cos \psi\right] \left(1 + \mathrm{e}^{-2 s_\phi}\right)^2 u_1} d t \]
\[ w_6 = w_{6, 0} + \eta_\phi \int_0^t \operatorname{sign}\left(\frac{\nabla y}{\nabla u_{2 d i s}}\right) \frac{4 I_x \varepsilon_\phi \left(y_d - y\right) \left(\phi_d - \phi\right) \mathrm{e}^{-2 s_\phi}}{l \left(1 + \mathrm{e}^{-2 s_\phi}\right)^2} d t \]

## Simulation and Results
Simulations are conducted using MATLAB/Simulink to validate the performance of the proposed control strategy. The quadrotor model is implemented, and the control algorithms are tested under various scenarios to evaluate their effectiveness.

### Performance Analysis
The results demonstrate that both SMC and adaptive neural network controllers successfully track the desired trajectories, with the adaptive controller showing improved performance in terms of reduced overshoot and better disturbance rejection.

## Conclusion
The adaptive SMC controller based on neural networks provides a robust and efficient method for controlling the position of a quadrotor UAV. The adaptive component allows the controller to adjust to varying conditions, improving overall system performance.

## Reference
Razmi, H., & Afshinfar, S. (2019). Neural network-based adaptive sliding mode control design for position and attitude control of a quadrotor UAV. Aerospace Science and Technology, 91, 12â€“27. [DOI:10.1016/j.ast.2019.04.055](http://dx.doi.org/10.1016/j.ast.2019.04.055)

